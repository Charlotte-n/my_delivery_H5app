import{y as e,z as t,A as a,B as n,C as i,r as o,D as l,u as r,G as s,o as u,H as v,I as c,J as d,K as f,d as p,L as m,b as h,c as g,f as y,j as I,w as _,M as w,N as k,E as b,O as C,e as x,P as S,l as M,T,m as j,Q as E,R as N,S as L,F as H,i as A,t as P,U as $,V as B,W as O,X as R,Y as z,Z as V,$ as D,q as W,_ as K,k as U,a0 as Y,p as F,h as G,n as J,a1 as X,v as Z,a as q,a2 as Q,s as ee}from"./index-mV6jAJcw.js";import{v as te}from"./el-loading-dqimmT6V.js";import{H as ae}from"./index-hQK-mbdR.js";import{g as ne,a as ie}from"./delivery-home-P8IFB8c4.js";import{u as oe}from"./index-yz0OpbAC.js";import{f as le}from"./vnode-cHJ0DHGx.js";import{i as re,a as se,r as ue}from"./get-LVbWSPPF.js";import{S as ve}from"./index-Xsk4qB8r.js";import{l as ce}from"./listenBottomOut-Y2N2QcEh.js";import{u as de,P as fe}from"./pullDown-_P2zCMiU.js";import{b as pe}from"./city-GAKJnE27.js";import{u as me}from"./position-Q-d2mI4y.js";import"./use-global-config-cR9LpW4d.js";import"./index-HC5mE-n5.js";import"./index-nURT9tW6.js";import"./index-s902GNGE.js";import"./index-fssVXj-i.js";var he=/\s/;var ge=/^\s+/;function ye(e){return e?e.slice(0,function(e){for(var t=e.length;t--&&he.test(e.charAt(t)););return t}(e)+1).replace(ge,""):e}var Ie=NaN,_e=/^[-+]0x[0-9a-f]+$/i,we=/^0b[01]+$/i,ke=/^0o[0-7]+$/i,be=parseInt;function Ce(e){if("number"==typeof e)return e;if(re(e))return Ie;if(se(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=se(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=ye(e);var a=we.test(e);return a||ke.test(e)?be(e.slice(2),a?2:8):_e.test(e)?Ie:+e}var xe=function(){return ue.Date.now()},Se="Expected a function",Me=Math.max,Te=Math.min;function je(e,t,a){var n,i,o,l,r,s,u=0,v=!1,c=!1,d=!0;if("function"!=typeof e)throw new TypeError(Se);function f(t){var a=n,o=i;return n=i=void 0,u=t,l=e.apply(o,a)}function p(e){var a=e-s;return void 0===s||a>=t||a<0||c&&e-u>=o}function m(){var e=xe();if(p(e))return h(e);r=setTimeout(m,function(e){var a=t-(e-s);return c?Te(a,o-(e-u)):a}(e))}function h(e){return r=void 0,d&&n?f(e):(n=i=void 0,l)}function g(){var e=xe(),a=p(e);if(n=arguments,i=this,s=e,a){if(void 0===r)return function(e){return u=e,r=setTimeout(m,t),v?f(e):l}(s);if(c)return clearTimeout(r),r=setTimeout(m,t),f(s)}return void 0===r&&(r=setTimeout(m,t)),l}return t=Ce(t)||0,se(a)&&(v=!!a.leading,o=(c="maxWait"in a)?Me(Ce(a.maxWait)||0,t):o,d="trailing"in a?!!a.trailing:d),g.cancel=function(){void 0!==r&&clearTimeout(r),u=0,n=s=i=r=void 0},g.flush=function(){return void 0===r?l:h(xe())},g}function Ee(e,t,a){var n=!0,i=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return se(a)&&(n="leading"in a?!!a.leading:n,i="trailing"in a?!!a.trailing:i),je(e,t,{leading:n,maxWait:t,trailing:i})}const Ne=(a,n)=>{const i={},o=e([]);return{children:o,addChild:e=>{i[e.uid]=e,o.value=((e,a,n)=>le(e.subTree).filter((e=>{var n;return t(e)&&(null==(n=e.type)?void 0:n.name)===a&&!!e.component})).map((e=>e.component.uid)).map((e=>n[e])).filter((e=>!!e)))(a,n,i)},removeChild:e=>{delete i[e],o.value=o.value.filter((t=>t.uid!==e))}}},Le=a({initialIndex:{type:Number,default:0},height:{type:String,default:""},trigger:{type:String,values:["hover","click"],default:"hover"},autoplay:{type:Boolean,default:!0},interval:{type:Number,default:3e3},indicatorPosition:{type:String,values:["","none","outside"],default:""},arrow:{type:String,values:["always","hover","never"],default:"hover"},type:{type:String,values:["","card"],default:""},loop:{type:Boolean,default:!0},direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},pauseOnHover:{type:Boolean,default:!0}}),He={change:(e,t)=>[e,t].every(n)},Ae=Symbol("carouselContextKey"),Pe=(a,n,p)=>{const{children:m,addChild:h,removeChild:g}=Ne(f(),"ElCarouselItem"),y=i(),I=o(-1),_=o(null),w=o(!1),k=o(),b=o(0),C=o(!0),x=l((()=>"never"!==a.arrow&&!r(T))),S=l((()=>m.value.some((e=>e.props.label.toString().length>0)))),M=l((()=>"card"===a.type)),T=l((()=>"vertical"===a.direction)),j=l((()=>"auto"!==a.height?{height:a.height}:{height:`${b.value}px`,overflow:"hidden"})),E=Ee((e=>{P(e)}),300,{trailing:!0}),N=Ee((e=>{!function(e){"hover"===a.trigger&&e!==I.value&&(I.value=e)}(e)}),300);function L(){_.value&&(clearInterval(_.value),_.value=null)}function H(){a.interval<=0||!a.autoplay||_.value||(_.value=setInterval((()=>A()),a.interval))}const A=()=>{I.value<m.value.length-1?I.value=I.value+1:a.loop&&(I.value=0)};function P(e){if(d(e)){const t=m.value.filter((t=>t.props.name===e));t.length>0&&(e=m.value.indexOf(t[0]))}if(e=Number(e),Number.isNaN(e)||e!==Math.floor(e))return;const t=m.value.length,n=I.value;I.value=e<0?a.loop?t-1:0:e>=t?a.loop?0:t-1:e,n===I.value&&$(n),B()}function $(e){m.value.forEach(((t,a)=>{t.translateItem(a,I.value,e)}))}function B(){L(),a.pauseOnHover||H()}s((()=>I.value),((e,t)=>{$(t),C.value&&(e%=2,t%=2),t>-1&&n("change",e,t)})),s((()=>a.autoplay),(e=>{e?H():L()})),s((()=>a.loop),(()=>{P(I.value)})),s((()=>a.interval),(()=>{B()}));const O=e();return u((()=>{s((()=>m.value),(()=>{m.value.length>0&&P(a.initialIndex)}),{immediate:!0}),O.value=oe(k.value,(()=>{$()})),H()})),v((()=>{L(),k.value&&O.value&&O.value.stop()})),c(Ae,{root:k,isCardType:M,isVertical:T,items:m,loop:a.loop,addItem:h,removeItem:g,setActiveItem:P,setContainerHeight:function(e){"auto"===a.height&&(b.value=e)}}),{root:k,activeIndex:I,arrowDisplay:x,hasLabel:S,hover:w,isCardType:M,items:m,isVertical:T,containerStyle:j,isItemsTwoLength:C,handleButtonEnter:function(e){r(T)||m.value.forEach(((t,a)=>{e===function(e,t){var a,n,i,o;const l=r(m),s=l.length;if(0===s||!e.states.inStage)return!1;const u=t+1,v=t-1,c=s-1,d=l[c].states.active,f=l[0].states.active,p=null==(n=null==(a=l[u])?void 0:a.states)?void 0:n.active,h=null==(o=null==(i=l[v])?void 0:i.states)?void 0:o.active;return t===c&&f||p?"left":!!(0===t&&d||h)&&"right"}(t,a)&&(t.states.hover=!0)}))},handleButtonLeave:function(){r(T)||m.value.forEach((e=>{e.states.hover=!1}))},handleIndicatorClick:function(e){I.value=e},handleMouseEnter:function(){w.value=!0,a.pauseOnHover&&L()},handleMouseLeave:function(){w.value=!1,H()},setActiveItem:P,prev:function(){P(I.value-1)},next:function(){P(I.value+1)},PlaceholderItem:function(){var e;const n=null==(e=y.default)?void 0:e.call(y);if(!n)return null;const i=le(n).filter((e=>t(e)&&"ElCarouselItem"===e.type.name));return 2===(null==i?void 0:i.length)&&a.loop&&!M.value?(C.value=!0,i):(C.value=!1,null)},isTwoLengthShow:e=>!C.value||(I.value<=1?e<=1:e>1),throttledArrowClick:E,throttledIndicatorHover:N}},$e=["onMouseenter","onClick"],Be={key:0},Oe=p({name:"ElCarousel"});var Re=$(p({...Oe,props:Le,emits:He,setup(e,{expose:t,emit:a}){const n=e,{root:i,activeIndex:o,arrowDisplay:s,hasLabel:u,hover:v,isCardType:c,items:d,isVertical:f,containerStyle:p,handleButtonEnter:$,handleButtonLeave:B,handleIndicatorClick:O,handleMouseEnter:R,handleMouseLeave:z,setActiveItem:V,prev:D,next:W,PlaceholderItem:K,isTwoLengthShow:U,throttledArrowClick:Y,throttledIndicatorHover:F}=Pe(n,a),G=m("carousel"),J=l((()=>{const e=[G.b(),G.m(n.direction)];return r(c)&&e.push(G.m("card")),e})),X=l((()=>{const e=[G.e("indicators"),G.em("indicators",n.direction)];return r(u)&&e.push(G.em("indicators","labels")),"outside"===n.indicatorPosition&&e.push(G.em("indicators","outside")),r(f)&&e.push(G.em("indicators","right")),e}));return t({setActiveItem:V,prev:D,next:W}),(e,t)=>(h(),g("div",{ref_key:"root",ref:i,class:w(r(J)),onMouseenter:t[6]||(t[6]=k(((...e)=>r(R)&&r(R)(...e)),["stop"])),onMouseleave:t[7]||(t[7]=k(((...e)=>r(z)&&r(z)(...e)),["stop"]))},[y("div",{class:w(r(G).e("container")),style:L(r(p))},[r(s)?(h(),I(T,{key:0,name:"carousel-arrow-left",persisted:""},{default:_((()=>[M(y("button",{type:"button",class:w([r(G).e("arrow"),r(G).em("arrow","left")]),onMouseenter:t[0]||(t[0]=e=>r($)("left")),onMouseleave:t[1]||(t[1]=(...e)=>r(B)&&r(B)(...e)),onClick:t[2]||(t[2]=k((e=>r(Y)(r(o)-1)),["stop"]))},[x(r(b),null,{default:_((()=>[x(r(C))])),_:1})],34),[[S,("always"===e.arrow||r(v))&&(n.loop||r(o)>0)]])])),_:1})):j("v-if",!0),r(s)?(h(),I(T,{key:1,name:"carousel-arrow-right",persisted:""},{default:_((()=>[M(y("button",{type:"button",class:w([r(G).e("arrow"),r(G).em("arrow","right")]),onMouseenter:t[3]||(t[3]=e=>r($)("right")),onMouseleave:t[4]||(t[4]=(...e)=>r(B)&&r(B)(...e)),onClick:t[5]||(t[5]=k((e=>r(Y)(r(o)+1)),["stop"]))},[x(r(b),null,{default:_((()=>[x(r(E))])),_:1})],34),[[S,("always"===e.arrow||r(v))&&(n.loop||r(o)<r(d).length-1)]])])),_:1})):j("v-if",!0),x(r(K)),N(e.$slots,"default")],6),"none"!==e.indicatorPosition?(h(),g("ul",{key:0,class:w(r(X))},[(h(!0),g(H,null,A(r(d),((t,a)=>M((h(),g("li",{key:a,class:w([r(G).e("indicator"),r(G).em("indicator",e.direction),r(G).is("active",a===r(o))]),onMouseenter:e=>r(F)(a),onClick:k((e=>r(O)(a)),["stop"])},[y("button",{class:w(r(G).e("button"))},[r(u)?(h(),g("span",Be,P(t.props.label),1)):j("v-if",!0)],2)],42,$e)),[[S,r(U)(a)]]))),128))],2)):j("v-if",!0)],34))}}),[["__file","carousel.vue"]]);const ze=a({name:{type:String,default:""},label:{type:[String,Number],default:""}}),Ve=(e,t)=>{const a=B(Ae),n=f(),i=.83,l=o(),s=o(!1),v=o(0),c=o(1),d=o(!1),p=o(!1),m=o(!1),h=o(!1),{isCardType:g,isVertical:y}=a;const I=(e,t,n)=>{var o;const s=r(g),u=null!=(o=a.items.value.length)?o:Number.NaN,f=e===t;s||z(n)||(h.value=f||e===n),!f&&u>2&&a.loop&&(e=function(e,t,a){const n=a-1,i=a/2;return 0===t&&e===n?-1:t===n&&0===e?a:e<t-1&&t-e>=i?a+1:e>t+1&&e-t>=i?-2:e}(e,t,u));const I=r(y);d.value=f,s?(m.value=Math.round(Math.abs(e-t))<=1,v.value=function(e,t){var n,i;const o=r(y)?(null==(n=a.root.value)?void 0:n.offsetHeight)||0:(null==(i=a.root.value)?void 0:i.offsetWidth)||0;return m.value?o*(1.17*(e-t)+1)/4:e<t?-1.83*o/4:3.83*o/4}(e,t),c.value=r(d)?1:i):v.value=function(e,t,n){const i=a.root.value;return i?((n?i.offsetHeight:i.offsetWidth)||0)*(e-t):0}(e,t,I),p.value=!0,f&&l.value&&a.setContainerHeight(l.value.offsetHeight)};return u((()=>{a.addItem({props:e,states:O({hover:s,translate:v,scale:c,active:d,ready:p,inStage:m,animating:h}),uid:n.uid,translateItem:I})})),R((()=>{a.removeItem(n.uid)})),{carouselItemRef:l,active:d,animating:h,hover:s,inStage:m,isVertical:y,translate:v,isCardType:g,scale:c,ready:p,handleItemClick:function(){if(a&&r(g)){const e=a.items.value.findIndex((({uid:e})=>e===n.uid));a.setActiveItem(e)}}}},De=p({name:"ElCarouselItem"});var We=$(p({...De,props:ze,setup(e){const t=e,a=m("carousel"),{carouselItemRef:n,active:i,animating:o,hover:s,inStage:u,isVertical:v,translate:c,isCardType:d,scale:f,ready:p,handleItemClick:y}=Ve(t),I=l((()=>({transform:[`${"translate"+(r(v)?"Y":"X")}(${r(c)}px)`,`scale(${r(f)})`].join(" ")})));return(e,t)=>M((h(),g("div",{ref_key:"carouselItemRef",ref:n,class:w([r(a).e("item"),r(a).is("active",r(i)),r(a).is("in-stage",r(u)),r(a).is("hover",r(s)),r(a).is("animating",r(o)),{[r(a).em("item","card")]:r(d),[r(a).em("item","card-vertical")]:r(d)&&r(v)}]),style:L(r(I)),onClick:t[0]||(t[0]=(...e)=>r(y)&&r(y)(...e))},[r(d)?M((h(),g("div",{key:0,class:w(r(a).e("mask"))},null,2)),[[S,!r(i)]]):j("v-if",!0),N(e.$slots,"default")],6)),[[S,r(p)]])}}),[["__file","carousel-item.vue"]]);const Ke=V(Re,{CarouselItem:We}),Ue=D(We),Ye={class:"banner"},Fe=["onClick"],Ge=["src"],Je={class:"category_title"},Xe=K(p({__name:"index",setup(e){const t=W(),a=o(),n=(e,t)=>{const a=[],n=Math.floor(e.length/t);for(let i=0;i<n;i++)a.push(e.slice(i*t,(i+1)*t));return a},i=e=>{let t=decodeURIComponent(e.split("=")[1].replace("&target_name",""));return/restaurant_category_id/gi.test(t)?JSON.parse(t).restaurant_category_id.id:""};return u((()=>{(async()=>{const e=await ne(),t=n(e,8);a.value=t})()})),(e,n)=>{const o=Ue,l=Ke;return h(),g("div",Ye,[x(l,{autoplay:!1,arrow:"never",height:"50vw"},{default:_((()=>[(h(!0),g(H,null,A(a.value,(e=>(h(),I(o,{key:e,class:"category"},{default:_((()=>[(h(!0),g(H,null,A(e,(e=>(h(),g("div",{key:e.id,class:"food_cate",onClick:a=>((e,a)=>{const n=i(e);t.push({name:"detail_food",params:{id:392|n,title:a}})})(e.link,e.title)},[y("img",{src:"https://fuss10.elemecdn.com"+e.image_url,alt:""},null,8,Ge),y("div",Je,P(e.title),1)],8,Fe)))),128))])),_:2},1024)))),128))])),_:1})])}}}),[["__scopeId","data-v-922a7507"]]),Ze={class:"nearby_business"},qe={class:"title"},Qe=(e=>(F("data-v-17eaf4e9"),e=e(),G(),e))((()=>y("span",null,"附近商家",-1))),et={key:0},tt=K(p({__name:"index",props:{PosiInfo:{}},setup(e,{expose:t}){const a=de(),n=e,i=l((()=>a.getMore)),s=o(!1),v=o([]),c=o({latitude:String(n.PosiInfo.latitude),longitude:String(n.PosiInfo.longitude),limit:20,offset:0}),d=async()=>{const e=await ie(c.value);0!==e.length?(c.value.offset+=20,v.value=[...v.value,...e]):s.value=!0},f=ce(s,d),p=o();return u((()=>{d(),window.addEventListener("scroll",f)})),R((()=>{window.removeEventListener("scroll",f,!1)})),t({getShoppingRestaurantApi:d}),(e,t)=>{const a=b,n=te;return h(),g("div",Ze,[y("div",qe,[x(a,{size:"4vw"},{default:_((()=>[x(r(Y))])),_:1}),Qe]),y("div",{class:"businesses",ref_key:"business",ref:p},[(h(!0),g(H,null,A(v.value,(e=>(h(),g("div",{key:e.id},[x(ve,{shopListInfo:e},null,8,["shopListInfo"])])))),128)),i.value?M((h(),g("p",et,[U("下拉加载更多")])),[[n,i.value]]):j("",!0)],512)])}}}),[["__scopeId","data-v-17eaf4e9"]]),at={class:"header-v1"},nt={key:0},it={key:1},ot={key:0,style:{height:"20px"}},lt={class:"banner"},rt={class:"home_nearby-business"},st=(e=>(F("data-v-88a0d172"),e=e(),G(),e))((()=>y("div",{class:"zhan"},null,-1))),ut=K(p({__name:"index",setup(e){const t=W(),a=Z(),n=me(),i=J(),s=de(),v=l((()=>s.pullUpRefresh)),c=o(),d=o(),f=o(""),p=o({}),m=async()=>{const e=String(a.params.geohash),t=await pe(e);f.value=t.name,p.value=t,n.$patch({longitude:t.longitude,latitude:t.latitude})},I=()=>{t.push({path:"/search"})},w=()=>{t.push({path:"/user"})},k=()=>{m()},C=o(!1);return u((async()=>{C.value=!0,await m(),C.value=!1,await X((()=>{fe(c.value,k,d.value.getShoppingRestaurantApi)}))})),R((()=>{})),(e,t)=>{const a=b,n=q("router-link"),o=te;return h(),g(H,null,[y("header",at,[x(ae,{cityName:f.value},{left:_((()=>[x(a,{onClick:I,size:"25"},{default:_((()=>[x(r(Q))])),_:1})])),right:_((()=>[""==r(i).userInfo.user_id||null==r(i).userInfo.user_id?(h(),g("div",nt,[x(n,{to:"/",class:"login"},{default:_((()=>[U("登录")])),_:1}),x(n,{to:"/",class:"register"},{default:_((()=>[U("注册")])),_:1})])):(h(),g("div",it,[x(a,{size:"30",onClick:w},{default:_((()=>[x(r(ee))])),_:1})]))])),_:1},8,["cityName"])]),M((h(),g("main",{ref_key:"main",ref:c},[y("div",null,[v.value?M((h(),g("div",ot,[U(" 下拉刷新 ")])),[[o,v.value]]):j("",!0),y("div",lt,[x(Xe)]),y("div",rt,[x(tt,{PosiInfo:p.value,ref_key:"nearby",ref:d},null,8,["PosiInfo"])]),st])])),[[o,C.value||v.value]])],64)}}}),[["__scopeId","data-v-88a0d172"]]);export{ut as default};
