import{A as s,d as a,L as e,D as l,b as t,c as n,f as i,R as o,M as c,u as d,j as r,w as u,aP as p,e as v,N as m,E as f,m as _,S as g,T as h,U as y,Z as k,t as w,x as b,p as j,h as x,_ as C,r as q,o as I,F as A,i as M,v as z,q as S,l as B,P as E,k as O,V as R,X as F,I as D}from"./index-ViSgIzPt.js";import{v as V}from"./el-loading-DIomWoV7.js";import{E as T,a as N}from"./el-menu-item--Hp7K0TE.js";import{f as $,a as P}from"./formate_img-ey60ccwK.js";import{E as U}from"./el-overlay-HtsOxKaZ.js";import{E as G}from"./el-button-gkmq5rc8.js";import{u as L}from"./cart-H4fPl9P-.js";import{C as X}from"./index-i76PfAWn.js";import{c as Z}from"./index-xGxDuspP.js";import{a as H}from"./use-form-item-jGvByu3r.js";import{G as J,d as Q,e as W,f as Y,h as K}from"./delivery-home-P8IFB8c4.js";import{l as ss}from"./listenBottomOut-Y2N2QcEh.js";import{b as as,c as es}from"./pullDown-JXsBmpp-.js";import"./use-global-config-GTjhXvXt.js";import"./index-dHxrGSiF.js";import"./get-LVbWSPPF.js";import"./index-RKveMh3y.js";import"./index-itvs8pL0.js";import"./aria-ClGo7ZJR.js";import"./isNil-csfYP8KJ.js";import"./index-lsKYVFE5.js";import"./focus-trap-PoazpTOY.js";import"./constants-JSdZFONt.js";import"./index-s6KMGca5.js";import"./icon-All7pErH.js";import"./index-DiWhqvS4.js";import"./error-lyDbv7Kx.js";import"./typescript-fEetNX7U.js";import"./vnode-E7H75w-I.js";import"./event-DkVV3hnh.js";import"./index-fssVXj-i.js";const ls=s({type:{type:String,values:["success","info","warning","danger",""],default:""},closable:Boolean,disableTransitions:Boolean,hit:Boolean,color:{type:String,default:""},size:{type:String,values:Z,default:""},effect:{type:String,values:["dark","light","plain"],default:"light"},round:Boolean}),ts={close:s=>s instanceof MouseEvent,click:s=>s instanceof MouseEvent},ns=a({name:"ElTag"});const is=k(y(a({...ns,props:ls,emits:ts,setup(s,{emit:a}){const y=s,k=H(),w=e("tag"),b=l((()=>{const{type:s,hit:a,effect:e,closable:l,round:t}=y;return[w.b(),w.is("closable",l),w.m(s),w.m(k.value),w.m(e),w.is("hit",a),w.is("round",t)]})),j=s=>{a("close",s)},x=s=>{a("click",s)};return(s,a)=>s.disableTransitions?(t(),n("span",{key:0,class:c(d(b)),style:g({backgroundColor:s.color}),onClick:x},[i("span",{class:c(d(w).e("content"))},[o(s.$slots,"default")],2),s.closable?(t(),r(d(f),{key:0,class:c(d(w).e("close")),onClick:m(j,["stop"])},{default:u((()=>[v(d(p))])),_:1},8,["class","onClick"])):_("v-if",!0)],6)):(t(),r(h,{key:1,name:`${d(w).namespace.value}-zoom-in-center`,appear:""},{default:u((()=>[i("span",{class:c(d(b)),style:g({backgroundColor:s.color}),onClick:x},[i("span",{class:c(d(w).e("content"))},[o(s.$slots,"default")],2),s.closable?(t(),r(d(f),{key:0,class:c(d(w).e("close")),onClick:m(j,["stop"])},{default:u((()=>[v(d(p))])),_:1},8,["class","onClick"])):_("v-if",!0)],6)])),_:3},8,["name"]))}}),[["__file","tag.vue"]])),os=s=>(j("data-v-3940a607"),s=s(),x(),s),cs={class:"header"},ds={class:"top"},rs={class:"main"},us={class:"img"},ps=["src"],vs={class:"shop_detail"},ms={class:"name"},fs={class:"delivery_detail"},_s=os((()=>i("span",{class:"inform"}," 公告:欢迎光临,用餐高峰期请提前下单,谢谢 ",-1))),gs={class:"activity"},hs=os((()=>i("div",{class:"act-left"},"满减优惠",-1))),ys={class:"act-right"},ks=os((()=>i("span",null,">",-1))),ws=C(a({__name:"index",props:{shopInfo:{}},setup(s){const a=s,e=()=>{history.go(-1)};return(s,l)=>{var o,c,r,p,m,_;const g=f;return t(),n("div",cs,[i("div",ds,[i("span",{class:"back",onClick:e},[v(g,null,{default:u((()=>[v(d(b))])),_:1})]),i("div",rs,[i("div",us,[i("img",{src:d($)(null==(o=a.shopInfo)?void 0:o.image_path),alt:""},null,8,ps)]),i("div",vs,[i("span",ms,w(null==(c=a.shopInfo)?void 0:c.name),1),i("span",fs," 商家配送/分钟送达/"+w(null==(p=null==(r=a.shopInfo)?void 0:r.piecewise_agent_fee)?void 0:p.tips),1),_s])])]),i("div",gs,[hs,i("div",ys,[i("span",null,w(null==(_=null==(m=a.shopInfo)?void 0:m.activities)?void 0:_.length)+"个活动",1),ks])])])}}}),[["__scopeId","data-v-3940a607"]]),bs=s=>(j("data-v-bd0a2334"),s=s(),x(),s),js={class:"good_detail"},xs={class:"left"},Cs={class:"food_cates"},qs=["onClick"],Is={class:"text1-ellipsis"},As={class:"right"},Ms={class:"title text1-ellipsis",style:{width:"17vw",display:"inline-block"}},zs={class:"text1-ellipsis",style:{width:"17vw",display:"inline-block"}},Ss=["onClick"],Bs=["src"],Es=["onClick"],Os={class:"good_name text1-ellipsis"},Rs={style:{"font-size":"2.6vw"}},Fs={class:"good_number"},Ds=["onClick"],Vs=[bs((()=>i("svg",{t:"1703259019839",class:"icon add",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"3340",width:"20",height:"20"},[i("path",{d:"M514.048 62.464q93.184 0 175.616 35.328t143.872 96.768 96.768 143.872 35.328 175.616q0 94.208-35.328 176.128t-96.768 143.36-143.872 96.768-175.616 35.328q-94.208 0-176.64-35.328t-143.872-96.768-96.768-143.36-35.328-176.128q0-93.184 35.328-175.616t96.768-143.872 143.872-96.768 176.64-35.328zM772.096 576.512q26.624 0 45.056-18.944t18.432-45.568-18.432-45.056-45.056-18.432l-192.512 0 0-192.512q0-26.624-18.944-45.568t-45.568-18.944-45.056 18.944-18.432 45.568l0 192.512-192.512 0q-26.624 0-45.056 18.432t-18.432 45.056 18.432 45.568 45.056 18.944l192.512 0 0 191.488q0 26.624 18.432 45.568t45.056 18.944 45.568-18.944 18.944-45.568l0-191.488 192.512 0z","p-id":"3341"})],-1)))],Ts={key:1,class:"add_and_jian"},Ns=["onClick"],$s=[bs((()=>i("path",{d:"M507.904 52.224q95.232 0 179.2 36.352t145.92 98.304 98.304 145.408 36.352 178.688-36.352 179.2-98.304 145.92-145.92 98.304-179.2 36.352-178.688-36.352-145.408-98.304-98.304-145.92-36.352-179.2 36.352-178.688 98.304-145.408 145.408-98.304 178.688-36.352zM736.256 573.44q30.72 0 55.296-15.872t24.576-47.616q0-30.72-24.576-45.568t-55.296-14.848l-452.608 0q-30.72 0-56.32 14.848t-25.6 45.568q0 31.744 25.6 47.616t56.32 15.872l452.608 0z","p-id":"1963"},null,-1)))],Ps=["onClick"],Us=[bs((()=>i("path",{d:"M514.048 62.464q93.184 0 175.616 35.328t143.872 96.768 96.768 143.872 35.328 175.616q0 94.208-35.328 176.128t-96.768 143.36-143.872 96.768-175.616 35.328q-94.208 0-176.64-35.328t-143.872-96.768-96.768-143.36-35.328-176.128q0-93.184 35.328-175.616t96.768-143.872 143.872-96.768 176.64-35.328zM772.096 576.512q26.624 0 45.056-18.944t18.432-45.568-18.432-45.056-45.056-18.432l-192.512 0 0-192.512q0-26.624-18.944-45.568t-45.568-18.944-45.056 18.944-18.432 45.568l0 192.512-192.512 0q-26.624 0-45.056 18.432t-18.432 45.056 18.432 45.568 45.056 18.944l192.512 0 0 191.488q0 26.624 18.432 45.568t45.056 18.944 45.568-18.944 18.944-45.568l0-191.488 192.512 0z","p-id":"3341"},null,-1)))],Gs={key:2},Ls=bs((()=>i("div",{style:{height:"15vw"}},null,-1))),Xs={class:"guige_detail"},Zs=bs((()=>i("span",{style:{"margin-bottom":"2vw",color:"black","font-size":"3vw"}},"规格",-1))),Hs={class:"guige_btn"},Js={class:"dialog-footer"},Qs={style:{"font-size":"3.8vw",color:"#ff692f"}},Ws=C(a({__name:"index",props:{foodMenu:{}},setup(s){const a=z(),e=S(),l=L(),o=s,p=q(0),m=q(!1),f=q(""),_=q([]),g=q(),h=q({}),y=()=>{x.value=0},k=q({}),b=async(s,a)=>{const e=a||0;l.changeCartData(s,e),D(s)},j=s=>{k.value={restaurant_id:s.restaurant_id,category_id:s.category_id,item_id:s.item_id,food_id:s.specfoods[0].food_id,name:s.name,price:s.specfoods[0].price,specs:s.specfoods[0].specs,count:1},e.push({path:"/delivery/food_detail/",query:{img_path:s.image_path,description:s.description,name:s.name,month_sale:s.month_sales,pinglun:s.satisfy_count,haoping:s.satisfy_rate,cartData:JSON.stringify(k.value)}})},x=q(0),C=q(),R=s=>{var e;const t=q();Object.keys(l.cartItems).find((s=>{s===String(a.params.shop_id)&&(t.value=l.cartItems[s])}));let n=0;return null==(e=t.value)||e.forEach((a=>{a.category_id===s&&(n+=a.count)})),n},F=s=>(C.value=s.specfoods[0].food_id,1==s.specfoods.length&&void 0===D(s)),D=s=>{var a;const e=q();Object.keys(l.cartItems).find((a=>{a===String(s.restaurant_id)&&(e.value=l.cartItems[a])}));const t=null==(a=e.value)?void 0:a.find((a=>{if(a.food_id===s.specfoods[0].food_id)return a}));return null==t?void 0:t.count};return I((()=>{})),(s,a)=>{const e=G,k=U;return t(),n(A,null,[i("div",js,[i("div",xs,[i("ul",Cs,[(t(!0),n(A,null,M(o.foodMenu,((s,a)=>(t(),n("li",{key:s.id,onClick:s=>(s=>{p.value=s,document.querySelectorAll(".title")[p.value].scrollIntoView({behavior:"smooth",block:"center"})})(a),class:c({"text1-ellipsis":!0,food_cate_item:!0,active:a===p.value})},[i("span",Is,w(s.name),1),B(i("span",{class:"num"},w(R(s.id)),513),[[E,R(s.id)]])],10,qs)))),128))])]),i("div",As,[(t(!0),n(A,null,M(o.foodMenu,(s=>(t(),n("div",{key:s.id},[i("header",{ref_for:!0,ref:"title"},[i("span",Ms,w(s.name),1),i("span",zs,w(s.description),1)],512),i("ul",null,[(t(!0),n(A,null,M(s.foods,(a=>(t(),n("li",null,[i("div",{class:"img",onClick:s=>j(a)},[i("img",{src:d($)(null==a?void 0:a.image_path),alt:""},null,8,Bs)],8,Ss),i("div",{class:"good_detail2",onClick:s=>j(a)},[i("span",Os,w(null==a?void 0:a.name),1),i("span",null,w(null==a?void 0:a.pinyin_name),1),i("span",Rs,w(null==a?void 0:a.tips),1),i("span",null,"￥"+w(null==a?void 0:a.specfoods[0].price),1)],8,Es),i("div",Fs,[i("span",null,w(a.specfoods[0].specs_name),1),F(a)?(t(),n("span",{key:0,onClick:s=>b(a)},Vs,8,Ds)):D(a)>=1?(t(),n("span",Ts,[(t(),n("svg",{t:"1703465549735",class:"icon jian",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1962",width:"20",height:"20",onClick:s=>(s=>{l.removeCartData(s)})(a)},$s,8,Ns)),i("span",null,w(D(a)),1),(t(),n("svg",{t:"1703259019839",class:"icon add",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"3340",width:"20",height:"20",onClick:s=>b(a)},Us,8,Ps))])):(t(),n("div",Gs,[v(e,{class:"btn",text:"",onClick:e=>((s,a,e)=>{m.value=!0,f.value=s,_.value=a,g.value=a[0].price,h.value=e})(s.name,a.specfoods,a)},{default:u((()=>[O(" 选规格 ")])),_:2},1032,["onClick"])]))])])))),256))])])))),128)),Ls])]),v(k,{modelValue:m.value,"onUpdate:modelValue":a[1]||(a[1]=s=>m.value=s),title:f.value,width:"60%",onClose:y},{footer:u((()=>[i("span",Js,[i("span",Qs,"￥"+w(g.value),1),v(e,{class:"btn",type:"primary",onClick:a[0]||(a[0]=s=>b(h.value,x.value))},{default:u((()=>[O(" 加入购物车 ")])),_:1})])])),default:u((()=>[i("div",Xs,[Zs,i("span",Hs,[(t(!0),n(A,null,M(_.value,((s,a)=>(t(),r(e,{class:c({"btn-1":!0,"active-right":a===x.value,"text1-ellipsis":!0}),onClick:e=>((s,a)=>{g.value=s.price,x.value=a})(s,a)},{default:u((()=>[O(w(s.specs_name),1)])),_:2},1032,["class","onClick"])))),256))])])])),_:1},8,["modelValue","title"])],64)}}}),[["__scopeId","data-v-bd0a2334"]]),Ys=s=>(j("data-v-e52ca6e0"),s=s(),x(),s),Ks={class:"all-assess"},sa={class:"left"},aa=Ys((()=>i("span",null,"综合评价",-1))),ea={class:"right"},la={class:"fuwu_assess"},ta=Ys((()=>i("span",null,"服务态度",-1))),na=Ys((()=>i("span",null,"星星代替",-1))),ia={class:"rate"},oa={class:"menu_assess"},ca=Ys((()=>i("span",null,"菜单评价",-1))),da=Ys((()=>i("span",null,"星星代替",-1))),ra={class:"rate"},ua=Ys((()=>i("div",{class:"arrive_time"},[i("span",null," 送达时间 "),i("span",{class:"rate"},"分钟")],-1))),pa=C(a({__name:"index",props:{assessRating:{}},setup(s){const a=s;return(s,e)=>{var l,o,c,d;return t(),n("div",Ks,[i("div",sa,[i("span",null,w(null==(l=a.assessRating.overall_score)?void 0:l.toFixed(2)),1),aa,i("span",null,"高于周围商店"+w(null==(o=a.assessRating.compare_rating)?void 0:o.toFixed(2))+"%",1)]),i("div",ea,[i("div",la,[ta,na,i("span",ia,w(null==(c=a.assessRating.service_score)?void 0:c.toFixed(2)),1)]),i("div",oa,[ca,da,i("span",ra,w(null==(d=a.assessRating.food_score)?void 0:d.toFixed(2)),1)]),ua])])}}}),[["__scopeId","data-v-e52ca6e0"]]),va={class:"detail_assessment",ref:"detail_assessment"},ma={class:"assess_cate"},fa=["onClick"],_a={class:"users_assessment"},ga={class:"img"},ha=["src"],ya={class:"back_content"},ka={class:"user_nickname"},wa=(s=>(j("data-v-418580ef"),s=s(),x(),s))((()=>i("span",{class:"user_rating"},"星星替代",-1))),ba={class:"user_back_text_img"},ja=["src"],xa={class:"tag"},Ca={class:"assess_time"},qa=C(a({__name:"index",props:{AccessCate:{},handleAssess:{type:Function}},setup(s){const a=s,e=R("AssessInfo"),l=q("全部");return I((async()=>{})),F((()=>{})),(s,o)=>{const p=is;return t(),n("div",va,[i("div",ma,[(t(!0),n(A,null,M(a.AccessCate,(s=>(t(),n("button",{class:c({btn:!0,active_btn:l.value===s.name}),key:s._id,onClick:e=>{return t=s.name,l.value=t,void a.handleAssess(t);var t}},w(s.name)+"("+w(s.count)+") ",11,fa)))),128))]),i("div",_a,[(t(!0),n(A,null,M(d(e),(s=>(t(),n("div",{class:"single_assessment",key:s._id},[i("div",ga,[i("img",{src:d(P)(s.avatar),alt:""},null,8,ha)]),i("div",ya,[i("span",ka,w(s.username),1),wa,i("span",ba,[(t(!0),n(A,null,M(s.item_ratings,(s=>(t(),n("span",{key:s._id,class:"user_back_img"},[s.image_hash?(t(),n("img",{key:0,src:d(P)(s.image_hash),alt:""},null,8,ja)):_("",!0)])))),128))]),i("span",xa,[(t(!0),n(A,null,M(s.item_ratings,(s=>(t(),r(p,{class:"ml-2 text1-ellipsis",type:"warning"},{default:u((()=>[O(w(s.food_name),1)])),_:2},1024)))),256))])]),i("div",Ca,w(s.rated_at),1)])))),128))])],512)}}}),[["__scopeId","data-v-418580ef"]]),Ia=a({__name:"index",props:{handleAssess:{type:Function}},setup(s){const a=z(),e=s,l=q({}),i=q([]),o=q();return I((()=>{(async()=>{l.value=await J(a.params.shop_id)})(),(async()=>{i.value=await Q(a.params.shop_id)})()})),(s,a)=>(t(),n(A,null,[v(pa,{assessRating:l.value},null,8,["assessRating"]),v(qa,{AccessCate:i.value,ref_key:"detailAssessment",ref:o,handleAssess:e.handleAssess},null,8,["AccessCate","handleAssess"])],64))}}),Aa={class:"shop-detail"},Ma={class:"header-1"},za={class:"menu"},Sa={key:0,style:{height:"90vh"}},Ba={key:0,style:{height:"70vh"}},Ea={key:0,style:{height:"70vh"}},Oa=C(a({__name:"delivery-shop-detail",setup(s){const a=z(),e=q({}),l=q([]),o=q(1);let c=null;const r=s=>{if(o.value=s,2==o.value){let s=document.querySelector(".assess_main");c=ss(m,h,s)}},p=q([]),m=q(!1),f=q({tag_name:"",offset:0,limit:20}),g=s=>{f.value.offset=0,f.value.tag_name=s,h()};D("AssessInfo",p);const h=async()=>{const s=await K(a.params.shop_id,f.value);if(0===s.length)return m.value=!0,!0;f.value.offset+=20,p.value=[...p.value,...s]},y=q(!1),k=()=>{};return I((async()=>{y.value=!0,await(async()=>{e.value=await W(a.params.shop_id)})(),await(async()=>{l.value=await Y(a.params.shop_id)})(),await h(),y.value=!1,as(k)})),F((()=>{es(k)})),(s,m)=>{const f=N,h=T,k=V;return t(),n("div",Aa,[i("header",Ma,[v(ws,{shopInfo:e.value},null,8,["shopInfo"])]),i("div",za,[v(h,{"default-active":"1",class:"el-menu-demo",mode:"horizontal",onSelect:r},{default:u((()=>[v(f,{index:"1",class:"good"},{default:u((()=>[O("商品")])),_:1}),v(f,{index:"2",class:"ping"},{default:u((()=>[O("评价")])),_:1})])),_:1})]),y.value?B((t(),n("div",Sa,null,512)),[[k,y.value]]):_("",!0),B(i("main",null,[1==o.value&&0===Object.keys(l.value).length?B((t(),n("div",Ba,null,512)),[[k,1==o.value&&0===Object.keys(l.value).length]]):_("",!0),v(Ws,{foodMenu:l.value},null,8,["foodMenu"])],512),[[E,1==o.value]]),B(i("main",{class:"assess_main",onScroll:m[0]||(m[0]=(...s)=>d(c)&&d(c)(...s)),ref:"main_assess"},[2==o.value&&0===Object.keys(p.value).length?B((t(),n("div",Ea,null,512)),[[k,2==o.value&&0===Object.keys(p.value).length]]):_("",!0),v(Ia,{ref:"assessment",handleAssess:g},null,512)],544),[[E,2==o.value]]),B(i("footer",null,[v(X,{restaruant_id:d(a).params.shop_id,shopInfo:e.value},null,8,["restaruant_id","shopInfo"])],512),[[E,1==o.value]])])}}}),[["__scopeId","data-v-28d2f13c"]]);export{Oa as default};
